(function(e){function t(t){for(var n,i,s=t[0],c=t[1],l=t[2],d=0,p=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&p.push(r[i][0]),r[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(p.length)p.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,s=1;s<a.length;s++){var c=a[s];0!==r[c]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},r={app:0},o=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/mosenergo/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("main-layout")},o=[],i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",{attrs:{id:"inspire"}},[a("v-system-bar",{attrs:{app:""}},[a("v-spacer"),a("v-icon",[e._v("mdi-square")]),a("v-icon",[e._v("mdi-circle")]),a("v-icon",[e._v("mdi-triangle")])],1),a("v-navigation-drawer",{attrs:{app:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("v-sheet",{staticClass:"pa-4",attrs:{color:"grey lighten-4"}},[a("v-avatar",{staticClass:"mb-4",attrs:{color:"grey darken-1",size:"64"}},[a("img",{attrs:{src:"https://w7.pngwing.com/pngs/980/886/png-transparent-male-portrait-avatar-computer-icons-icon-design-avatar-flat-face-icon-people-head-cartoon.png",alt:"John"}})]),a("div",[e._v("admin@mosenergo.com")])],1),a("v-divider"),a("v-list",e._l(e.links,(function(t){var n=t[0],r=t[1],o=t[2];return a("v-list-item",{key:n,attrs:{link:"",to:o}},[a("v-list-item-icon",[a("v-icon",[e._v(e._s(n))])],1),a("v-list-item-content",[a("v-list-item-title",[e._v(e._s(r))])],1)],1)})),1)],1),a("v-main",[a("v-container",{staticClass:"py-8 px-6",attrs:{fluid:""}},[a("router-view")],1)],1)],1)},s=[],c={data:function(){return{cards:["Today","Yesterday"],drawer:null,links:[["mdi-home","Главная","/"],["mdi-chart-areaspline","Анализ","/charts"]]}}},l=c,u=a("2877"),d=a("6544"),p=a.n(d),v=a("7496"),h=a("8212"),f=a("a523"),m=a("ce7e"),g=a("132d"),y=a("8860"),b=a("da13"),_=a("5d23"),C=a("34c3"),x=a("f6c4"),k=a("f774"),w=a("8dd9"),O=a("2fa4"),V=a("afd9"),T=Object(u["a"])(l,i,s,!1,null,null,null),j=T.exports;p()(T,{VApp:v["a"],VAvatar:h["a"],VContainer:f["a"],VDivider:m["a"],VIcon:g["a"],VList:y["a"],VListItem:b["a"],VListItemContent:_["a"],VListItemIcon:C["a"],VListItemTitle:_["b"],VMain:x["a"],VNavigationDrawer:k["a"],VSheet:w["a"],VSpacer:O["a"],VSystemBar:V["a"]});var L={components:{MainLayout:j},name:"App"},M=L,P=Object(u["a"])(M,r,o,!1,null,null,null),S=P.exports,I=a("8c4f"),A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("Home")])},D=[],E={},F=E,$=Object(u["a"])(F,A,D,!1,null,null,null),z=$.exports,H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",{staticClass:"text-h5 mb-4"},[e._v("Анализ данных")]),a("v-row",[a("v-col",[a("v-label",[e._v("Выберите файл с данными часового потребления ЮЛ")])],1),a("v-col",{attrs:{cols:"9"}},[a("v-file-input",{attrs:{disabled:e.isLoading,accept:".csv","hide-details":"",label:"csv-file","show-size":"",outlined:"",dense:""},on:{change:e.selectFile}}),e.isLoading?a("v-progress-linear",{staticClass:"mt-1",attrs:{height:"20"},model:{value:e.progress,callback:function(t){e.progress=t},expression:"progress"}},[a("strong",[e._v("Анализ данных: "+e._s(e.progress)+"%")])]):e._e()],1)],1),e.chartOptions.series[0].data.length?a("v-row",[a("v-col",[a("highcharts",{ref:"highcharts",attrs:{options:e.chartOptions,"constructor-type":"stockChart"}})],1)],1):e._e(),a("v-row",[a("v-col",[a("v-label",[e._v("Выберите файл с ОКВЭД по ЮЛ ")])],1),a("v-col",{attrs:{cols:"9"}},[a("v-file-input",{attrs:{disabled:!e.chartOptions.series[0].data.length,accept:".csv","hide-details":"",label:"csv-file","show-size":"",outlined:"",dense:""},on:{change:e.setOkved}})],1)],1),a("v-row",[a("v-col",[a("v-label",[e._v("Выберите файл с ценовыми категориями ")])],1),a("v-col",{attrs:{cols:"9"}},[a("v-file-input",{attrs:{disabled:!e.okvedKeys.length,accept:".csv","hide-details":"",label:"csv-file","show-size":"",outlined:"",dense:""},on:{change:e.setPriceCategory}})],1)],1),a("v-row",[a("v-col",[e.company.length?a("v-select",{attrs:{items:e.company,label:"Выберите отрасль","item-text":"okved_name","return-object":"",dense:"",outlined:""},on:{change:e.createChart},model:{value:e.selectedCompany,callback:function(t){e.selectedCompany=t},expression:"selectedCompany"}}):e._e()],1)],1),e.chartOptionsCompany.series[0].data.length&&!e.reinit?a("v-row",[a("v-col",[a("highcharts",{ref:"highcharts",attrs:{options:e.chartOptionsCompany,"constructor-type":"stockChart"}})],1)],1):e._e()],1)},N=[],J=a("2909"),K=(a("b64b"),a("99af"),a("4e827"),a("a9e3"),a("d81d"),a("d3b7"),a("159b"),a("4de4"),a("369b")),q=a.n(K),B=a("ea7f"),R=a.n(B),Y=a("37d8"),G=a.n(Y);G()(R.a);var Q={data:function(){return{chartOptions:{title:{text:"График медианных значений потребления электроэнергии по всем юридическим лицам"},xAxis:{type:"datetime",title:{text:"Дата"}},yAxis:{title:{text:"Медианное значение потребления электроэнергии"}},series:[{showInLegend:!1,data:[]}]},chartOptionsCompany:{title:{text:""},xAxis:{type:"datetime",title:{text:"Дата"}},yAxis:{title:{text:"Медианное значение потребления электроэнергии"}},series:[{showInLegend:!1,data:[]}]},progress:0,isLoading:!1,sortedHourlyConsumption:[],priceCategory:[],company:[],okved:{},selectedCompany:null,hourlyConsumptionFull:[],reinit:!1}},computed:{okvedKeys:function(){return Object.keys(this.okved)}},watch:{selectedCompany:function(){this.selectedCompany&&(this.chartOptionsCompany.title.text="График медианных значений потребления электроэнергии для отрасли: ".concat(this.selectedCompany.okved_name))}},methods:{selectFile:function(e){var t=this;if(!e)return this.chartOptions.series[0].data=[],void(this.progress=0);this.isLoading=!0;var a=0,n=1539625,r=[];q.a.parse(e,{header:!0,step:function(e){var o=e.data,i=o.registration_date,s=o.hour;e.data.unixTime=new Date("".concat(i," ").concat(s,":00")).getTime()/1e3,t.hourlyConsumptionFull.push(e.data),r.push(e.data),a++,t.progress=Math.floor(a/n*100),a>=n&&(t.isLoading=!1,t.sortedHourlyConsumption=r.sort((function(e,t){return e.unixTime-t.unixTime})),t.generateChartData(r,t.chartOptions.series[0].data))}})},generateChartData:function(e,t){for(var a=[],n=0,r=0,o=1;o<e.length;o++)1===o?n+=Number(e[1].energy_taken_kVth):e[o].unixTime===e[o-1].unixTime?n+=Number(e[o].energy_taken_kVth):(a.push({energy_taken_kVth:Math.floor(n),unixTime:e[o-1].unixTime}),n>r&&(r=Math.floor(n)),n=0);var i=a.map((function(e){var t=Math.floor(e.energy_taken_kVth/r*100);return[1e3*e.unixTime+108e5,t]}));t.push.apply(t,Object(J["a"])(i))},setOkved:function(e){var t=this;e?q.a.parse(e,{header:!0,complete:function(e){var a={};e.data.forEach((function(e){a[e.id]=e.okved_name})),t.okved=a}}):this.okved={}},setPriceCategory:function(e){var t=this;if(e){var a=[];q.a.parse(e,{header:!0,complete:function(e){t.priceCategory=e.data.filter((function(e){return Number(e.useful_vacation_kVt>0)})),t.priceCategory.forEach((function(e){"undefined"!==typeof t.okved[e.id]&&a.push({id:e.id,okved_name:t.okved[e.id]})})),t.company=a}})}else this.priceCategory=[]},createChart:function(){var e=this;this.chartOptionsCompany.series[0].data=[],setTimeout((function(){var t=e.hourlyConsumptionFull.filter((function(t){return t.id==e.selectedCompany.id}));t=t.sort((function(e,t){return e.unixTime-t.unixTime})),e.generateChartData(t,e.chartOptionsCompany.series[0].data)}),100)},sync:function(e,t){}}},U=Q,W=a("62ad"),X=a("23a7"),Z=a("24c9"),ee=a("8e36"),te=a("0fd9"),ae=a("b974"),ne=Object(u["a"])(U,H,N,!1,null,null,null),re=ne.exports;p()(ne,{VCol:W["a"],VFileInput:X["a"],VLabel:Z["a"],VProgressLinear:ee["a"],VRow:te["a"],VSelect:ae["a"]}),n["default"].use(I["a"]);var oe=[{path:"/",name:"Home",component:z},{path:"/charts",name:"Charts",component:re}],ie=new I["a"]({base:"/mosenergo/",routes:oe}),se=ie,ce=a("2f62");n["default"].use(ce["a"]);var le=new ce["a"].Store({state:{},mutations:{},actions:{},modules:{}}),ue=a("f309"),de=a("e1bf");n["default"].use(ue["a"]);var pe=new ue["a"]({lang:{locales:{ru:de["a"]},current:"ru"}}),ve=a("4452"),he=a.n(ve);n["default"].use(he.a),n["default"].config.productionTip=!1,new n["default"]({router:se,store:le,vuetify:pe,render:function(e){return e(S)}}).$mount("#app")}});
//# sourceMappingURL=app.44fb6d2f.js.map